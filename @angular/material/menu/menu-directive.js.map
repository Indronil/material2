{"version":3,"sources":["menu/menu-directive.ts"],"names":[],"mappings":"AAAA,0CAA0C;;;;;;;;;;;;;OAEnC,EACL,SAAS,EACT,SAAS,EACT,eAAe,EACf,YAAY,EACZ,KAAK,EACL,MAAM,EACN,SAAS,EACT,WAAW,EACX,SAAS,EACT,iBAAiB,EAClB,MAAM,eAAe;OAEf,EAAC,sBAAsB,EAAE,sBAAsB,EAAC,MAAM,eAAe;OACrE,EAAC,UAAU,EAAC,MAAM,aAAa;OAC/B,EAAC,QAAQ,EAAE,UAAU,EAAE,GAAG,EAAC,MAAM,SAAS;AAWjD;IAaE,gBAAqC,IAAmB,EACnB,IAAmB;QAbxD,sBAAiB,GAAY,KAAK,CAAC;QAC3B,sBAAiB,GAAW,CAAC,CAAC;QAKtC,cAAS,GAAkB,OAAO,CAAC;QACnC,cAAS,GAAkB,OAAO,CAAC;QAyBzB,UAAK,GAAG,IAAI,YAAY,CAAC;QAlBjC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAAC,CAAC;QACvC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAAC,CAAC;IACzC,CAAC;IASD,sBAAI,6BAAS;QAPb;;;;;WAKG;aAEH,UAAc,OAAe;YAC3B,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,GAAQ,EAAE,SAAiB;gBACtE,GAAG,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;gBACtB,MAAM,CAAC,GAAG,CAAC;YACb,CAAC,EAAE,EAAE,CAAC,CAAC;QACT,CAAC;;;OAAA;IAID;;;;OAIG;IACH,iCAAgB,GAAhB,UAAiB,IAAa;QAC5B,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAED;;;;OAIG;IACH,gCAAe,GAAf;QACE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;IAC3B,CAAC;IAED,wEAAwE;IACxE,iBAAiB;IACjB,+BAAc,GAAd,UAAe,KAAoB;QACjC,EAAE,CAAC,CAAC,KAAK,CAAC,OAAO,KAAK,UAAU,CAAC,CAAC,CAAC;YACjC,IAAI,CAAC,cAAc,EAAE,CAAC;QACxB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC5B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,OAAO,KAAK,GAAG,CAAC,CAAC,CAAC;YACjC,IAAI,CAAC,eAAe,EAAE,CAAC;QACzB,CAAC;IACH,CAAC;IAED;;;OAGG;IACK,gCAAe,GAAvB;QACE,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC;QAC3B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;IAEO,+BAAc,GAAtB;QACE,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC;QAChC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,KAAK,EAAE,CAAC;IACvD,CAAC;IAEO,mCAAkB,GAA1B;QACE,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC,CAAC;QACjC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,KAAK,EAAE,CAAC;IACvD,CAAC;IAED;;;;;;;;;SASK;IACG,wCAAuB,GAA/B,UAAgC,KAAa,EAAE,SAA8C;QAA9C,yBAA8C,GAA9C,YAA0B,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;QAC3F,wDAAwD;QACxD,IAAI,CAAC,iBAAiB,GAAG,CAAC,IAAI,CAAC,iBAAiB,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;cACjD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;QAE9C,+DAA+D;QAC/D,wDAAwD;QACxD,OAAO,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,QAAQ,EAAE,CAAC;YAClD,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;QACjD,CAAC;IACH,CAAC;IAEO,8BAAa,GAArB,UAAsB,GAAkB;QACtC,EAAE,CAAC,CAAE,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,OAAO,CAAC,CAAC,CAAC;YACzC,MAAM,IAAI,sBAAsB,EAAE,CAAC;QACrC,CAAC;QACD,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;IACvB,CAAC;IAEO,8BAAa,GAArB,UAAsB,GAAkB;QACtC,EAAE,CAAC,CAAE,GAAG,KAAK,OAAO,IAAI,GAAG,KAAK,OAAO,CAAC,CAAC,CAAC;YACxC,MAAM,IAAI,sBAAsB,EAAE,CAAC;QACrC,CAAC;QACD,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;IACvB,CAAC;IA5GD;QAAC,SAAS,CAAC,WAAW,CAAC;;+CAAA;IACvB;QAAC,eAAe,CAAC,UAAU,CAAC;;yCAAA;IAc5B;QAAC,KAAK,CAAC,OAAO,CAAC;;;2CAAA;IAQf;QAAC,MAAM,EAAE;;yCAAA;IA1CX;QAAC,SAAS,CAAC;YACT,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,SAAS;YACnB,IAAI,EAAE,EAAC,MAAM,EAAE,MAAM,EAAC;YACtB,WAAW,EAAE,WAAW;YACxB,SAAS,EAAE,CAAC,UAAU,CAAC;YACvB,aAAa,EAAE,iBAAiB,CAAC,IAAI;YACrC,QAAQ,EAAE,QAAQ;SACnB,CAAC;mBAca,SAAS,CAAC,YAAY,CAAC;mBACvB,SAAS,CAAC,YAAY,CAAC;;cAfpC;IAwHF,aAAC;AAAD,CAvHA,AAuHC,IAAA","file":"menu/menu-directive.js","sourcesContent":["// TODO(kara): prevent-close functionality\r\n\r\nimport {\r\n  Attribute,\r\n  Component,\r\n  ContentChildren,\r\n  EventEmitter,\r\n  Input,\r\n  Output,\r\n  QueryList,\r\n  TemplateRef,\r\n  ViewChild,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport {MenuPositionX, MenuPositionY} from './menu-positions';\r\nimport {MdMenuInvalidPositionX, MdMenuInvalidPositionY} from './menu-errors';\r\nimport {MdMenuItem} from './menu-item';\r\nimport {UP_ARROW, DOWN_ARROW, TAB} from '../core';\r\n\r\n@Component({\r\n  moduleId: module.id,\r\n  selector: 'md-menu',\r\n  host: {'role': 'menu'},\r\n  templateUrl: 'menu.html',\r\n  styleUrls: ['menu.css'],\r\n  encapsulation: ViewEncapsulation.None,\r\n  exportAs: 'mdMenu'\r\n})\r\nexport class MdMenu {\r\n  _showClickCatcher: boolean = false;\r\n  private _focusedItemIndex: number = 0;\r\n\r\n  // config object to be passed into the menu's ngClass\r\n  _classList: Object;\r\n\r\n  positionX: MenuPositionX = 'after';\r\n  positionY: MenuPositionY = 'below';\r\n\r\n  @ViewChild(TemplateRef) templateRef: TemplateRef<any>;\r\n  @ContentChildren(MdMenuItem) items: QueryList<MdMenuItem>;\r\n\r\n  constructor(@Attribute('x-position') posX: MenuPositionX,\r\n              @Attribute('y-position') posY: MenuPositionY) {\r\n    if (posX) { this._setPositionX(posX); }\r\n    if (posY) { this._setPositionY(posY); }\r\n  }\r\n\r\n  /**\r\n   * This method takes classes set on the host md-menu element and applies them on the\r\n   * menu template that displays in the overlay container.  Otherwise, it's difficult\r\n   * to style the containing menu from outside the component.\r\n   * @param classes list of class names\r\n   */\r\n  @Input('class')\r\n  set classList(classes: string) {\r\n    this._classList = classes.split(' ').reduce((obj: any, className: string) => {\r\n      obj[className] = true;\r\n      return obj;\r\n    }, {});\r\n  }\r\n\r\n  @Output() close = new EventEmitter;\r\n\r\n  /**\r\n   * This function toggles the display of the menu's click catcher element.\r\n   * This element covers the viewport when the menu is open to detect clicks outside the menu.\r\n   * TODO: internal\r\n   */\r\n  _setClickCatcher(bool: boolean): void {\r\n    this._showClickCatcher = bool;\r\n  }\r\n\r\n  /**\r\n   * Focus the first item in the menu. This method is used by the menu trigger\r\n   * to focus the first item when the menu is opened by the ENTER key.\r\n   * TODO: internal\r\n   */\r\n  _focusFirstItem() {\r\n    this.items.first.focus();\r\n  }\r\n\r\n  // TODO(kara): update this when (keydown.downArrow) testability is fixed\r\n  // TODO: internal\r\n  _handleKeydown(event: KeyboardEvent): void {\r\n    if (event.keyCode === DOWN_ARROW) {\r\n      this._focusNextItem();\r\n    } else if (event.keyCode === UP_ARROW) {\r\n      this._focusPreviousItem();\r\n    } else if (event.keyCode === TAB) {\r\n      this._emitCloseEvent();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This emits a close event to which the trigger is subscribed. When emitted, the\r\n   * trigger will close the menu.\r\n   */\r\n  private _emitCloseEvent(): void {\r\n    this._focusedItemIndex = 0;\r\n    this.close.emit(null);\r\n  }\r\n\r\n  private _focusNextItem(): void {\r\n    this._updateFocusedItemIndex(1);\r\n    this.items.toArray()[this._focusedItemIndex].focus();\r\n  }\r\n\r\n  private _focusPreviousItem(): void {\r\n    this._updateFocusedItemIndex(-1);\r\n    this.items.toArray()[this._focusedItemIndex].focus();\r\n  }\r\n\r\n  /**\r\n   * This method sets focus to the correct menu item, given a list of menu items and the delta\r\n   * between the currently focused menu item and the new menu item to be focused. It will\r\n   * continue to move down the list until it finds an item that is not disabled, and it will wrap\r\n   * if it encounters either end of the menu.\r\n   *\r\n   * @param delta the desired change in focus index\r\n   * @param menuItems the menu items that should be focused\r\n   * @private\r\n     */\r\n  private _updateFocusedItemIndex(delta: number, menuItems: MdMenuItem[] = this.items.toArray()) {\r\n    // when focus would leave menu, wrap to beginning or end\r\n    this._focusedItemIndex = (this._focusedItemIndex + delta + this.items.length)\r\n                              % this.items.length;\r\n\r\n    // skip all disabled menu items recursively until an active one\r\n    // is reached or the menu closes for overreaching bounds\r\n    while (menuItems[this._focusedItemIndex].disabled) {\r\n      this._updateFocusedItemIndex(delta, menuItems);\r\n    }\r\n  }\r\n\r\n  private _setPositionX(pos: MenuPositionX): void {\r\n    if ( pos !== 'before' && pos !== 'after') {\r\n      throw new MdMenuInvalidPositionX();\r\n    }\r\n    this.positionX = pos;\r\n  }\r\n\r\n  private _setPositionY(pos: MenuPositionY): void {\r\n    if ( pos !== 'above' && pos !== 'below') {\r\n      throw new MdMenuInvalidPositionY();\r\n    }\r\n    this.positionY = pos;\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}